{"ast":null,"code":"// stores/auth.js\nimport { defineStore } from 'pinia';\nimport axios from 'axios';\nexport const useAuthStore = defineStore({\n  id: 'auth',\n  // Store ID\n\n  state: () => ({\n    token: localStorage.getItem('token') || null,\n    // Initialize token from localStorage\n    isAuthenticated: !!localStorage.getItem('token') // Set isAuthenticated based on token existence\n  }),\n  actions: {\n    // Handle login and store the JWT token\n    async login(email, password) {\n      try {\n        const response = await axios.post('http://localhost:8000/api/token/', {\n          email,\n          password\n        });\n\n        // Use $patch to update multiple state properties at once\n        this.$patch({\n          token: response.data.access,\n          // Set the JWT token in the store\n          isAuthenticated: true // Mark the user as authenticated\n        });\n\n        // Store token in localStorage\n        localStorage.setItem('token', response.data.access);\n      } catch (error) {\n        console.error('Login failed:', error);\n        throw new Error('Login failed. Please check your credentials.');\n      }\n    },\n    // Handle logout by clearing the token and setting isAuthenticated to false\n    logout() {\n      this.$patch({\n        token: null,\n        // Clear the token from the store\n        isAuthenticated: false // Mark the user as logged out\n      });\n\n      // Remove token from localStorage\n      localStorage.removeItem('token');\n    },\n    // Restore the token from localStorage when the app is reloaded\n    restoreToken() {\n      const token = localStorage.getItem('token');\n      if (token) {\n        this.$patch({\n          token,\n          // Restore token to the store\n          isAuthenticated: true // Mark the user as authenticated\n        });\n      }\n    }\n  }\n});","map":{"version":3,"names":["defineStore","axios","useAuthStore","id","state","token","localStorage","getItem","isAuthenticated","actions","login","email","password","response","post","$patch","data","access","setItem","error","console","Error","logout","removeItem","restoreToken"],"sources":["/home/peter/projects/bus-frontend/src/stores/auth.js"],"sourcesContent":["// stores/auth.js\nimport { defineStore } from 'pinia';\nimport axios from 'axios';\n\nexport const useAuthStore = defineStore({\n  id: 'auth',  // Store ID\n\n  state: () => ({\n    token: localStorage.getItem('token') || null,  // Initialize token from localStorage\n    isAuthenticated: !!localStorage.getItem('token'),  // Set isAuthenticated based on token existence\n  }),\n\n  actions: {\n    // Handle login and store the JWT token\n    async login(email, password) {\n      try {\n        const response = await axios.post('http://localhost:8000/api/token/', {\n          email,\n          password,\n        });\n\n        // Use $patch to update multiple state properties at once\n        this.$patch({\n          token: response.data.access,  // Set the JWT token in the store\n          isAuthenticated: true,  // Mark the user as authenticated\n        });\n\n        // Store token in localStorage\n        localStorage.setItem('token', response.data.access);\n      } catch (error) {\n        console.error('Login failed:', error);\n        throw new Error('Login failed. Please check your credentials.');\n      }\n    },\n\n    // Handle logout by clearing the token and setting isAuthenticated to false\n    logout() {\n      this.$patch({\n        token: null,  // Clear the token from the store\n        isAuthenticated: false,  // Mark the user as logged out\n      });\n\n      // Remove token from localStorage\n      localStorage.removeItem('token');\n    },\n\n    // Restore the token from localStorage when the app is reloaded\n    restoreToken() {\n      const token = localStorage.getItem('token');\n      if (token) {\n        this.$patch({\n          token,  // Restore token to the store\n          isAuthenticated: true,  // Mark the user as authenticated\n        });\n      }\n    },\n  },\n});\n"],"mappings":"AAAA;AACA,SAASA,WAAW,QAAQ,OAAO;AACnC,OAAOC,KAAK,MAAM,OAAO;AAEzB,OAAO,MAAMC,YAAY,GAAGF,WAAW,CAAC;EACtCG,EAAE,EAAE,MAAM;EAAG;;EAEbC,KAAK,EAAEA,CAAA,MAAO;IACZC,KAAK,EAAEC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,IAAI,IAAI;IAAG;IAC/CC,eAAe,EAAE,CAAC,CAACF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAG;EACrD,CAAC,CAAC;EAEFE,OAAO,EAAE;IACP;IACA,MAAMC,KAAKA,CAACC,KAAK,EAAEC,QAAQ,EAAE;MAC3B,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAMZ,KAAK,CAACa,IAAI,CAAC,kCAAkC,EAAE;UACpEH,KAAK;UACLC;QACF,CAAC,CAAC;;QAEF;QACA,IAAI,CAACG,MAAM,CAAC;UACVV,KAAK,EAAEQ,QAAQ,CAACG,IAAI,CAACC,MAAM;UAAG;UAC9BT,eAAe,EAAE,IAAI,CAAG;QAC1B,CAAC,CAAC;;QAEF;QACAF,YAAY,CAACY,OAAO,CAAC,OAAO,EAAEL,QAAQ,CAACG,IAAI,CAACC,MAAM,CAAC;MACrD,CAAC,CAAC,OAAOE,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,eAAe,EAAEA,KAAK,CAAC;QACrC,MAAM,IAAIE,KAAK,CAAC,8CAA8C,CAAC;MACjE;IACF,CAAC;IAED;IACAC,MAAMA,CAAA,EAAG;MACP,IAAI,CAACP,MAAM,CAAC;QACVV,KAAK,EAAE,IAAI;QAAG;QACdG,eAAe,EAAE,KAAK,CAAG;MAC3B,CAAC,CAAC;;MAEF;MACAF,YAAY,CAACiB,UAAU,CAAC,OAAO,CAAC;IAClC,CAAC;IAED;IACAC,YAAYA,CAAA,EAAG;MACb,MAAMnB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAIF,KAAK,EAAE;QACT,IAAI,CAACU,MAAM,CAAC;UACVV,KAAK;UAAG;UACRG,eAAe,EAAE,IAAI,CAAG;QAC1B,CAAC,CAAC;MACJ;IACF;EACF;AACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}